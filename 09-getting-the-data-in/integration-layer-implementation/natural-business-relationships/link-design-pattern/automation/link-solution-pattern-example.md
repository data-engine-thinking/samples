# Link Solution pattern example
## Example pattern for a Link process

```sql
INSERT INTO [LINK_PRODUCT_SALE]
(
  [PRODUCT_SALE_SK],
  [AUDIT_TRAIL_ID],
  [CUSTOMER_SK],
  [SALE_TRANSACTION_SK],
  [PRODUCT_SK]
)
SELECT
(
  SELECT
    HASHBYTES('SHA1',
      COALESCE(TRIM(CONVERT(NVARCHAR(MAX),[CUSTOMER_ID])), '~!@|N/A') + '\@|' +
      COALESCE(TRIM(CONVERT(NVARCHAR(MAX),[SALE_TRANSACTION_ID])), '~!@|N/A') + '\@|'
      COALESCE(TRIM(CONVERT(NVARCHAR(MAX),[PRODUCT_ID])), '~!@|N/A') + '\@|'
    ) AS [PRODUCT_SALE_SK],
    HASHBYTES('SHA1',
      COALESCE(TRIM(CONVERT(NVARCHAR(MAX),[CUSTOMER_ID])), '~!@|N/A') + '\@|'
    ) AS [CUSTOMER_SK],
    HASHBYTES('SHA1',
      COALESCE(TRIM(CONVERT(NVARCHAR(MAX),[SALE_TRANSACTION_ID])), '~!@|N/A') + '\@|'
    ) AS [SALE_TRANSACTION_SK],
    HASHBYTES('SHA1',
      COALESCE(TRIM(CONVERT(NVARCHAR(MAX),[PRODUCT_ID])), '~!@|N/A') + '\@|'
    ) AS [PRODUCT_SK],
    0 AS [AUDIT_TRAIL_ID]
  FROM
  (
    SELECT DISTINCT
      [CODE] AS [CUSTOMER_ID],
      [TRANS_ID] AS [SALE_TRANSACTION_ID],
      [PROD_REF] AS [PRODUCT_ID],
    FROM [PSA_SALES] psa
  ) sub
) final
WHERE NOT EXISTS
  (
    SELECT 1
    FROM [LINK_PRODUCT_SALE] link
    WHERE Final.[PRODUCT_SALE_SK] = link.[PRODUCT_SALE_SK]
  )
```